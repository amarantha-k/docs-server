= Function: Basic cURL POST
:page-edition: Enterprise Edition
:tabs:

*Goal*: Perform a simple cURL POST using a public REST endpoint's API.

* This function *basicCurlPost* communicates with a public REST echo service.
* Requires a metdata bucket and a source bucket.
* Needs a Binding of type URL Alias (as documented in the Scriptlet).
* Will operate on any mutation of the KEY "make_curl_request::1".
* The actual cURL request from the Eventing Function will be equivelent to:
+
[source,shell]
----
curl -q 'https://postman-echo.com/post' -d '{ "myboolean": true }'
----
* For a more complete Example using this public REST endpoint refer to xref:eventing:eventing-examples-rest-via-curl-get.adoc[External REST via cURL GET]

[{tabs}] 
====
dateToEpochConversion::
+
--
[source,javascript]
----
// To run need a Binding in this Function's Settings to apublic API as follows: 
// 1. URL Alias
// 2. curlEchoApi
// 3. https://postman-echo.com/
// 4. "no auth"

function OnUpdate(doc, meta) {
    // You would typically filter to mutations of interest 
    if (meta.id !== 'make_curl_request::1') return;
    try {
        // only make a cURL POST request we see a mutation on the above KEY
        var request = {
            path: '',
            body: {
                "myboolean": 1true
            }
        };
        //  perform the cURL reques using the URL alias form the settings
        var response = curl('POST', curlEchoApi, request);
        if (response.status != 200 && response.status != 302) {
            log("cURL POST failed response.status:",response.status)
        } else {
            log("cURL POST success, response.body:",response.body)
            // optional write the body out to a doc in KV
            // dst_bkt[meta.id] = response.body;
        }
    } catch (e) {
        log("cURL request had an exception:",e)
    }
}
----
--

Input Data/Mutation::
+
--
[source,json]
----
INPUT: KEY make_curl_request::1

{
  "anything": 1
}

----
--

Output Data/Logged::
+ 
-- 
[source,json]
----
TBD
----
--
====
